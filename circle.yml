general:
    build_dir: android

dependencies:
    pre:
        - echo y | android update sdk --no-ui --all --filter "tools,platform-tools,android-23"
        - echo y | android update sdk --no-ui --all --filter "build-tools-24.0.0"
        - echo y | android update sdk --no-ui --all --filter "extra-android-m2repository"

test:
    pre:
        - emulator -avd circleci-android22 -no-audio -no-window:
            background: true
            parallel: true
        - circle-android wait-for-boot
        - adb shell input keyevent 82
        - adb shell svc power stayon true
        - adb shell settings put global window_animation_scale 0
        - adb shell settings put global transition_animation_scale 0
        - adb shell settings put global animator_duration_scale 0

    override:
        - ./gradlew test connectedAndroidTest

    post:
        - cp -r app/build/test-results/debug/ $CIRCLE_TEST_REPORTS
        - cp -r app/build/outputs/androidTest-results/ $CIRCLE_TEST_REPORTS
